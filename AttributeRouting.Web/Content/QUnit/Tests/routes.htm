<!DOCTYPE html>
<html>
<head>
	<title>QUnit Test Suite</title>
	<link href="/Content/QUnit/Styles/qunit.css" rel="stylesheet" type="text/css" media="screen">
	<script src="/Content/QUnit/Scripts/qunit.js" type="text/javascript"></script>
    <script src="/Content/Scripts/jquery-1.4.1.js" type="text/javascript"></script>
	<script>
	    $(function () {

	        asyncTest("GET test/index", function () {
	            expect(2); //we expect 2 asserts

	            $.getJSON('/test/index', function (data, status) {
	                console.log(status);

	                start(); //this starts the test
	                equal(data.controller, "TestController", "The controller should be 'TestController'");
	                equal(data.action, "Index", "The action should be 'Index'");
	            });

	        });

	        asyncTest("Parameters Should Map", function () {
	            expect(4);

	            $.getJSON("/test/parametersshouldmap/p1/p2", function (data, status) {
	                console.log(status);

	                start();

	                equal(data.controller, "TestController", "The controller should be 'TestController'");
	                equal(data.action, "ParametersShouldMap", "The action should be 'ParametersShouldMap'");
	                equal(data.param1, 'p1', "param1 should be 'p1'");
	                equal(data.param2, 'p2', "param2 should be 'p2'");
	            });

	        });


	        asyncTest("Throw error", function () {
	        	expect(1);

	        	$.ajax({
                    url: '/test/throwerror',
                    dataType: 'json',
                    success: function(data) {
                        start();
                        ok(false, "The server should have thrown a 500 error, but it didn't");
                    },
                    error: function(request, status, error) {
                        start();
                        equal(request.status, 500, "The server should throw a 500 error");
                        //ok(true, "The server threw an error");
                    },

                
                });
                
               

	        });

	        //todo: add more route tests here.
	    });
    
    </script>
</head>
<body>
	<h1 id="qunit-header">AttributeRouting Tests</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
</body>
</html>
